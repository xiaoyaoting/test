// 请求 4xx/5xx 的情况会判定为 accessible = true
// (基于 script tag 的检测方式, 会将 404 请求判定为 accessible = false)
// TODO: 存在 Mixed Content 问题
module.exports = async (url, timeout = 5000) => {
  let timer;
  try {
    const controller = new AbortController();
    timer = setTimeout(() => controller.abort(), timeout);
    // eslint-disable-next-line no-undef
    await fetch(url, { method: 'HEAD', mode: 'no-cors', signal: controller.signal });
    return true;
  } catch (e) {
    return false;
  } finally {
    clearTimeout(timer);
  }
};
